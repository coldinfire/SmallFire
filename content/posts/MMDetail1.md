---
title: "MM 包含流程解析"
date: 2019-03-10
draft: false
author: Small Fire
isCJKLanguage: true
categories: 
  - business

tags: 
  - MM

---

## 企业组织结构
### 整体架构 ###

 - 集团：是 R/3 系统里的一个商业的组织层次。有自己的数据、主记录及各种报表。从业务角度看，集团当作各个实体的组合。
 - 公司代码：一个公司代码代表一个独立的会计实体。每个公司代码都有它自己得到资产负债表和损益表。
 - 工厂：是公司内的组织单元，生产产品、提供服务或销售产品，工厂可以是（制造厂、仓库中转中心、 区域销售办公司、公司总部）
 - 仓储地点：是工厂内存放不同类型物料的组织单位，如：材料仓，成品仓，材损仓。
 - 采购组织：是负责为一个或多个工厂工厂采购物料和提供服务及与供应商协商价格和供货条款的主旨单位。价格条件在采购组织层次设置。如果一个采购组织为多个工厂采购，则价格在各个工厂都有效。
 - 采购组：是采购组织的进一步细分，负责日常的采购活动，一个采购组也可以为多个采购组织工作
#### 集团 / 公司代码 / 工厂 ####
![架构关系](/images/MM/Client1.png)
#### 公司代码 / 工厂 / 库存地点 ####
![架构关系](/images/MM/Client2.png)

### 物料主数据 ###
#### 主要信息: ####
  描述性信息：描述，尺寸，体积等

  控制性信息：MRP类型，价格控制，采购组等

物料主数据：

 - General:           Material Number、Description、Base Unit Of Measure、Technical
 - Plan Specific：MRP type、Planned delivery time、Purchasing group、Batch indicator
 - Valuation：     Valuation price、Valuation procedure、Valuated quantity

   物料主数据记录中的数据是集合在不同的视图中；不同部门会有不同的物料主数据视图。

#### 1.物料信息录入 ####
必须数据： 

 - 物料号：根据需求定义 ；
 - 行业领域：（控制哪些数据需要显示）；
 - 物料类型：（群组，归类）：控制哪些部门需要维护

设置：
```JS
SPRO：SAP后台配置 => 后勤常规--->物料主数据--->基本设置--->物料类型--->定义物料类型的属性
                详细信息--->用户部门（决定哪些部门需要维护）
                控制内外部采购订单：决定是不是自己生产的（影响采购类型）
                控制账户分类参考：
                控制数量/价值更新：决定数量和价值的更新
            客户供料：只会做数量更新，不会做价钱更新（不属于本公司）
            显示具体信息：设置显示（专家模式）
                成品（FERT）<Finished Product>
                半成品（HALB）<Semifinished Product>
                原材料（ROH）<Raw materials>
                备品备件（ERSA）<Spare Parts>
                贸易货物（HAWA）<Trading Goods>
                包装物料（VERP）<Packaging>
                可反复利用包装（LEIH）<Returnable packaging>
                未估价物料(UNBW)
                管线物料（PIPE）<Pipeline materials>
```

![视图](/images/MM/MMMain.png)
![数据屏幕](/images/MM/MMScreen.png)

#### 2.消耗型物料 ####
 - 办公材料 <成本中心>
 - 计算机系统 < 固定资产 >

<1> 消耗型物料时直接为了一个科目设置对象而购买的物料 (不需要办理入库和出库手续)

<2> 库存管理未被执行

<3> 系统会自动更新有物料主记录的消耗型物料

```JS
          库存物料            《=》              消耗型物料
    输入要求的物料编号                     可以输入物料编号，但不是必须的
    无科目设置类别                         强制科目设置类别
    过账到库存科目                         过账到消耗科目
    在物料主记录中更新数量和价值            消耗品更新（只使用于物料主记录中的物料）、移动平均价格被调整
```
 - 非库存物料（NLAG）: 有一定采购频率、是有物料主数据，但不做库存管理的物料。（价值，数量）。
	- 使用该物料类型（NLAG）的物料，创建采购订单需要指定账户分类（如 K 等）；根据采购订单收货时，直接财务上消耗记账。
 - 未评估物料（UNBW) : 做数量管理，不做价值管理
     - 使用该物料类型（UNBW）的物料，创建采购订单需要指定账户分类（如 K 等）；根据采购订单收货时，直接财务消耗记账，更新库存数量；消耗时，只记录库存数量减少。

#### 3.BOM ####
BOM：物料清单 (零件结构表)，将产品的原材料、零配件、组件予以拆解，并将各单位项材料依材料编号、名称、
规格、基本单位、单位用量、产品损耗等依制造流程的顺序记录下来，排列为一个清单，就是 BOM。
#### 4.MRP ####
MRP：物料需求计划，利用生产日程表（MPS）、零件结构表（BOM）、库存报表、已订购未交货订单等等
各种相关资料，经正确计算而得出各种物料零件的变量需求，提出各种新的订购或修正各种以开出订购
的物料管理技术。

![MRP原理](/images/MM/MRP.png)
![MRP](/images/MM/MRP2.png)

**MRP元素缩写**

SimReq：简单需求

AR：相关预订	

BA：采购申请	 

BB：提供物料转包商需求

BE：订单项目计划行

BP：总需求计划 

BR：流程订单

OrdRes：订单需求

PurRqs：采购申请

SubReq：外协请求

PrcOrd：处理订单

OI-SL：采购订单

PrdOrd：生产订单

PMOrdr：PM 订单

FE：生产订单	

IH：维护订单

CH：批库存

KB：单独客户库存	 

BtchSt：批量库存

CStock	客户库存

DD：有效外日期 

E1：分包合同采购

FH：计划时界末 

IW：工厂中（仅和 IS 汽车相关） 

JI：JIT 提取	

JIT：JIT 调用

#### 5.视图选择 ####
根据选择的部门不同，输入的内容也不同，系统自动识别所属类型.

**缺省值的设置。**
 - 行业领域、选择视图、组织级别都可以设置缺省值。
```JS
基本数据 1：一般属于物料描述等属性，属于集团类别。
X 单位：基本单位，订单单位，转换因子（附加数据中有计量单位的设定，
计量单位组：预先定义好单位转换 <通过后台设置关键字 设置计量单位组中进行设置的>）
X 物料组：做分析会用到、可以利用不同的物料组决定种类分类账
X 旧物料号： 便于查找旧系统数据
X 部门：Division (1) 影响 SD/FI 两个模块 (2) 无值将导致销售无法生成订单，单价录入，报告书等
实验室 / 办公室：描述信息没有特殊描述
X 产品组：根据公司产品分组，不填写销售无法生成订单
X 附加数据：通过附加数据来维护不同语言环境的物料描述
凭证数据、内部批注、计量单位
号码范围：通过后台维护 ---> 定义号码范围 （组 物料类型 定义号码范围）
外部给号，内部给号范围的限制。未检测的外部号分配
X 毛重、净重：报关使用

销售组织数据 1：
X 交货工厂编码：
X 税务数：国家，纳税类型
销售组织数据 2：影响销售订单
分组条款：
X 物料定价组：（固定值）
X 科目设置组：
X 项目类别组：（固定值）
物料组：X1，2，3，4，5
销售一般 / 工厂：影响销售的订单
工厂：工厂代码
批次管理：（包装品必须勾选）
运输组：
装载组：
利润中心：
采购：
采购组：用于区分资材类型（BOM、Non BOM） 报表所需
批次管理：（勾选，HANON 暂不使用）
配额安排：同意物料对应多个供应商时用到此值（用分配的比例确定供应商的纳品数）
源清单：物料与供应商信息的结合，不勾选，无法生成采购订单

MRP1：MRP 类型、MRP 控制者、批量（在 PP 中会使用到的）
MRP 组：
MRP 类型：（固定值 PD）
MRP 控制者：
批量大小：（固定值 EX）
MRP2：影响 MRP 运算
采购类型：内部生产或则外部采购
特殊采购类型：有偿加工必填 <31>, 无偿加工品必填 < 30>
外部采购仓储地点：物料存储仓库
计划边际码：采购品须填写准确日期，影响 MRP 运输
计划交货时间：进口件
MRP3：可用性检查（02）
策略组：内部生产品必填，固定值
MRP4:
  选择方法：内部生产品必填，固定值
  重复生产：内部生产品必填，固定值
  重复生产参数 文件：内部生产品必填，固定值
工厂数据 / 存储：
存储条件：关系到销售出库
End Item：直买直卖的物品必须勾选

会计 1：
评估分类：影响会计计算，必须准确
价格确定：系统自动存在，没有时必须输入

成本 1：
勾选物料来源：
主要视图：
基础视图 -- 物料基本描述（集团层次通用）- 不同的工厂，不同公司看到的数据都是一样的
采购视图 -- 采购模块数据
销售视图 -- 销售业务数据
生产视图 --MRP 数据
会计视图 -- 财务会计数据
成本视图 -- 成本会计数据
外部采购 与 计划交货时间（必输 <采购提前期>）

MRP：
MRP1：MRP 类型、MRP 控制者、批量（在 PP 中会使用到的）
MRP2：采购类型、计划交货时间、计划边际码
MRP3：可用性检查（02）
MRP4： 不输入
会计 1：
评估类、价格控制、价格单位、标准价格
后续可以不用输入。即可建立料号。
Control string：material type、plant、industry sector、transaction、procurement indicator（采购类型）
通过字段选择 --> 维护数据屏幕的字段选择来修改屏幕的状态
```

#### 6.组织层次 ####
工厂，库存地点，销售机构，分销渠道

## 库存采购基础  ##

![采购环境](/images/MM/Buy.png)

### 采购流程：  ###
 - 1. MRP & Purch.Req (Determination of reqmts)（确认需求）
 - 2. Source determination (购买方式和货源)
 - 3. Vendor selection （跟哪个供应商买）
 - 4. Request for Quotation (要求报价)
 - 5. Purchase Requisition (采购申请)
 - 6. PO processing （下采购订单）
 - 7. PO monitoring （订单跟踪）
 - 8. Goods receipt （收货）
 - 9. Invoice verfication （发票校验）
 - 10. Payment processing （付钱）

***MRP：***

 - 使用预计的制造生产计划来确定所需材料以及何时需要信息。

***供应商选择：***

 - 从报价中比较选择供应商。

***报价请求：***

 - 要求潜在供应商提交材料或服务报价。Quatation 包含供应商的条款和条件。

***采购申请：***

- 物料使用部门提出的队某种物料的需求
- 可以由系统自动生成 (MRP) 或手工生成
-  公司内部谁用文件
- 可以没有供应商、没有价格，只有评估价值
- 可以自动或手动地转化为采购订单
- 交货指示

***采购订单：***

- PO 是供应商在特定条件下提供某些材料或服务的正式请求。
- 询价 / 报价：第一次购买的物料，为一种库存物料创建一张采购订单
- 采购订单处理：参考采购订单输入一张物料接收，评估自动生成的各个凭证
- 收货：输入与采购订单相关的收据，同时进行价格及质量检查

**检查供应商发票：核实在发票过账基础上创建的财务会计凭证，验证其可信程度**

#### 询价报价 ####
 - 询价单 / 报价单：ME41/ME47 <RFQ> 
 - 打印询价单：ME9A 
 - 价格对比：ME49 
 - 信息清单：ME11

1. 确定购买需求
2. 确定货源的供应
3. 向选定的多个供应商发送询价单（物料价格，物料数量，送货时间，等等）
4. 根据供应商返回的报价单挑选合适的 (报价单处理：输入价格和条件，应用价格比较列表比较报价单)
5. 参照报价单创建采购订单


**采购信息记录和价格决定：**

1）手工输入价钱

2）如果手工没有输入，系统找 Info record，如果信息记录中有合适的价钱，采用 Info record 价格。

3 ）没有Info record价格，最后采用 PO 价钱，也可以不从最后的 PO 带入价格。

**配额协议**

**货源清单 (Source List)**

**信息记录 (Info record)**：ME11（手工输入，报价单，采购订单，框架协议更新）
：一个物料在某个供应商那里，卖多少钱，有什么特殊条件等信息的存储。

**价格条件：**
报价价格、采购订单、信息记录、框架协议会 （用到价格条件类型）

市场价：对个供应商的价格平均值，查询市场价 <MEKH>

采购订单：将采购订单发送给供应商《同时发送给生产的工厂》产生采购凭证

```JS
价钱条件：ME12
手工创建采购订单：ME21N       
跟踪采购订单：ME23N
采购订单订单查询：ME2L
一般数据：供应商数据、原始数据、订购单位等
价格和条件：总价格、折扣、运费、关税、其他
控制数据：交付时间、最小数量、容差
文本：采购订单文本、Int.信息记录备注
统计：价格历史记录、采购订单统计、改变历史记录. . . . . 

订单结构：
    PR Header : 采购订单编号、供应商、货币、付款期限、采购订单日期
    PR Item : 物料编号、短文本、发货日期、采购订单数量、采购订单价格、分类
    科目设置对象：
        A：资产    K：成本中心    P：项目    F：订单(生产，考虑)    C：销售订单    其他
无物料的采购订单：
    采购订单中不输入物料，只输入描述
    可以收获，但是必须是直接消耗，没有库存管理
    适用于低值品的采购           
采购合同   <联系、集成、自动>   采购订单
```
**自动采购：**

 - 主数据和合同,资源清单
 - 物料需求计划(MRP)
 - 自动生成采购单
 - 发送通知和物料接收
 - 评估收货结算(ERS)

![采购订单的自动生成](/images/MM/PRecord.png)

**收货：事务代码 《MIGO》**

1. 供应商根据采购订单将货物发送到指定地区，以及发票
2. 工厂在收货地点进行收货
3. 收货时同时产生物料凭证和会计凭证 创建物料凭证：MB03
4. 货物会收到指定的 Location <货物移动凭证>
5. 移动类型：仓库收货 <101>、退货发运 < 122>. . . . . .

收货后：

 - 会更新物料主数据的工厂库存视图 (库存查看 MMBE, MB52)
 - 物料凭证，会计凭证产生
 - 自动触发启用 QM/WM
 - 采购订单历史数据更新

![收货实现](/images/MM/GR.png)
![凭证产生](/images/MM/proof.png)
**发票校验：**

1. 主数据、发票、采购订单、物料凭证综合数据进行发票校验
2. 根据校验的结果生产发票凭证 <发票校验科目>
3. 记账过账处理
4. 根据发票凭证触发付款程序

![发票检验](/images/MM/invoice1.png)
![凭证产生](/images/MM/invoice2.png)

**记账过账：**

1. 根据采购订单、物料凭证、发票信息进行记账
2. 发票过账时，会创建一张会计凭证。各项目将被发送到相应的科目。