---
title: " 维护会计凭证号范围 "
date: 2019-07-19
draft: false
author: Small Fire
isCJKLanguage: true
categories: 
  - ABAP

tags: 
  - abaputils

---

### 简介

在一个公司代码（Company Code）生成一张会计凭证（Accounting Document）之前，必须在对凭证类型设置一个号码范围。由于做账有多种凭证类型，则需在一个公司代码下配置一套由多个条目组成的号码范围。

每个号码段由序号区间编号（Number range number）、记账年份、起始编号、结束编号、是否外部编号等 5 个数据组成，每个序号区间编号可以有多个记账年份，其中可以是指定年份（如 2013、2014 年等），也可以是默认年份（固定为 9999 年）。如果在本年度的号码段没有指定记账年份，则会使用默认年份的编号段，如果两者（指定和默认）都没有则会报错。

创建的方法有两种：新建法和复制法。

- 新建法是在一个公司代码下手工创建每一个号码段
- 复制法是复制已维护的公司代码数据，原公司代码的数据需要维护完整，Client 自带的公司代码 0001 可作为样例，只是记账年份仅有默认年份（9999 年），可根据需要扩充。

SAP 还提供了专项批量维护会计凭证号码段的事物码：

- OBH1 适用于将一个公司代码的某个年度的号码范围，复制到多个公司代码下
- OBH2 则是将指定的公司代码的某个年度的号码范围，复制到另一个年度下

### 维护

| IMG 路径                                                     | TCOCE | SNRO/SNUM维护值 |
| ------------------------------------------------------------ | ----- | --------------- |
| SAP 用户化实施指南→财务会计 (新)→财务会计全局设置 (新)→凭证→凭证号范围→条目视图中的凭证→定义条目视图的凭证编号范围 | FBN1  | RF_BELEG        |

进入维护界面有三种方法均可使用。

### 复制法

初始界面输入公司代码。可以通过复制功能直接复制之前已经存在的数据。

![FBN1](/images/ABAP/ABAP_NumberRange18.png)

点击修改间隔按钮进入，可以看到已有几十条号码范围，在此界面可以再进行维护。如无误，按保存按钮保存，再按返回按钮退出操作。

![Change interval](/images/ABAP/ABAP_NumberRange19.png)

### 新建法

#### 操作

进入操作界面，输入需维护的公司代码。点击"Intervals"按钮，维护公司代码号码范围界面。

![Change interval](/images/ABAP/ABAP_NumberRange20.png)

新建间隔，点击 "Insert Interval" 按钮，进入插入间隔对话框界面。

依次输入号、年、起始号、终止号，并指定是否是外部给号。点击保存按钮保存新Item。

![Add Interval](/images/ABAP/ABAP_NumberRange21.png)

点击保存按钮保存退出。连续按返回按钮退出操作。

